@model ICCMS_Web.Models.MaintenanceRequestDto
@{
    var statusClass = Model.Status?.ToLower() switch
    {
        "pending" => "warning",
        "in progress" => "info",
        "resolved" => "success",
        "cancelled" => "danger",
        _ => "secondary"
    };
}

<!-- ðŸ”¹ Maintenance Request Details (for modal use) -->
<div class="container-fluid">
    <div class="card shadow-sm mb-3">
        <div class="card-header bg-white border-0 py-3">
            <h5 class="mb-0">
                <i class="fas fa-info-circle me-2 text-danger"></i>Request Information
            </h5>
        </div>
        <div class="card-body small">
            <div class="row">
                <div class="col-6 mb-2">
                    <label class="text-muted small">Request ID</label>
                    <p class="fw-semibold mb-0">@Model.MaintenanceRequestId</p>
                </div>
                <div class="col-6 mb-2">
                    <label class="text-muted small">Priority</label>
                    <p class="fw-semibold mb-0">@Model.Priority</p>
                </div>
                <div class="col-6 mb-2">
                    <label class="text-muted small">Project</label>
                    <p class="mb-0">@Model.ProjectId</p>
                </div>
                <div class="col-6 mb-2">
                    <label class="text-muted small">Requested By</label>
                    <p class="mb-0">@Model.RequestedBy</p>
                </div>
                <div class="col-12 mb-2">
                    <label class="text-muted small">Description</label>
                    <p class="mb-0">@Model.Description</p>
                </div>
                <div class="col-12 mt-2">
                    <span class="badge bg-@statusClass px-3 py-2 fs-6">@Model.Status</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ðŸ“¸ Attached Photo -->
    <div class="card shadow-sm mb-3">
        <div class="card-header bg-white border-0 py-3">
            <h5 class="mb-0">
                <i class="fas fa-camera me-2 text-primary"></i>Attached Photo
            </h5>
        </div>
        <div class="card-body text-center">
            @if (!string.IsNullOrWhiteSpace(Model.MediaUrl))
            {
                <img src="@Model.MediaUrl"
                     alt="Attached Media"
                     class="img-fluid rounded shadow-sm mb-2"
                     style="max-height: 350px; object-fit: contain; cursor: pointer;"
                     onclick="showImageModal('@Model.MediaUrl')" />
                <p class="text-muted small mb-0">Click to view in full size</p>
            }
            else
            {
                <div class="text-center py-3">
                    <i class="fas fa-image fa-2x text-muted mb-2"></i>
                    <p class="text-muted small mb-0">No image attached.</p>
                </div>
            }
        </div>
    </div>

    <!-- â³ Timeline -->
    <div class="card shadow-sm">
        <div class="card-header bg-white border-0 py-3">
            <h5 class="mb-0">
                <i class="fas fa-clock me-2 text-info"></i>Request Timeline
            </h5>
        </div>
        <div class="card-body small">
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-marker bg-primary"></div>
                    <div class="timeline-content">
                        <h6 class="mb-1">Created</h6>
                        <p class="text-muted mb-0">@Model.CreatedAt.ToString("MMM dd, yyyy")</p>
                    </div>
                </div>

                @if (Model.ResolvedAt.HasValue)
                {
                    <div class="timeline-item">
                        <div class="timeline-marker bg-success"></div>
                        <div class="timeline-content">
                            <h6 class="mb-1">Resolved</h6>
                            <p class="text-muted mb-0">@Model.ResolvedAt.Value.ToString("MMM dd, yyyy")</p>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<style>
    .timeline {
        position: relative;
        padding-left: 25px;
    }

    .timeline::before {
        content: '';
        position: absolute;
        left: 12px;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: #e9ecef;
    }

    .timeline-item {
        position: relative;
        margin-bottom: 20px;
    }

    .timeline-marker {
        position: absolute;
        left: 5px;
        top: 6px;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        border: 2px solid #fff;
        box-shadow: 0 0 0 2px #e9ecef;
    }
</style>
