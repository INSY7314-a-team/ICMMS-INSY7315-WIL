@model List<ICCMS_Web.Models.Quote>
@{ ViewData["Title"]="Quotes"; }
<div class="container py-3">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 mb-0">Quotes</h1>
    <a class="btn btn-primary" asp-action="Create">Create Quote</a>
  </div>

  @if (TempData["ok"]!=null){ <div class="alert alert-success">@TempData["ok"]</div> }

  <div class="card">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-sm align-middle mb-0">
          <thead><tr>
            <th>ID</th><th>Title</th><th>Project</th><th>Status</th>
            <th>Total</th><th>Created</th><th></th>
          </tr></thead>
          <tbody>
          @foreach (var q in Model){
            <tr>
              <td>@q.Id</td>
              <td>@q.Title</td>
              <td>@q.ProjectId</td>
              <td>@q.Status</td>
              <td>R @q.Total.ToString("N0")</td>
              <td>@q.CreatedAt.ToLocalTime().ToString("g")</td>
              <td class="text-end">
                @if(q.Status=="Draft"){
                  <form asp-action="Send" method="post" class="d-inline">
                    <input type="hidden" name="id" value="@q.Id" />
                    <button class="btn btn-sm btn-outline-primary">Send</button>
                  </form>
                }
                @if(q.Status=="Sent"){
                  <a class="btn btn-sm btn-success" asp-action="Accept" asp-route-id="@q.Id">Mock Accept</a>
                  <a class="btn btn-sm btn-danger" asp-action="Reject" asp-route-id="@q.Id">Mock Reject</a>
                }
              </td>
            </tr>
          }
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
